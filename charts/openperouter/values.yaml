# Default values for openperouter.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

nameOverride: ""
fullnameOverride: ""

rbac:
  # create specifies whether to install and use RBAC rules.
  create: true

openperouter:
  # -- Controller log level. Must be one of: `debug`, `info`, `warn` or `error`.
  logLevel: info
  tolerateMaster: true
  # -- If true, all pods (router, controller, and nodemarker) are allowed to run on master/control-plane nodes
  runOnMaster: true
  # -- If true, enables host mode deployment: deploys hostbridge DaemonSet instead of router and controller,
  # and configures nodemarker to run in webhook-only mode
  hostmode: false
  # -- Multus network annotation to be added to router pods
  multusNetworkAnnotation: ""
  image:
    repository: quay.io/openperouter/router
    tag: ""
    pullPolicy: ""
  ## ref: https://kubernetes.io/docs/tasks/manage-daemon/update-daemon-set/
  ##
  updateStrategy:
    ## StrategyType
    ## Can be set to RollingUpdate or OnDelete
    ##
    type: RollingUpdate
  serviceAccounts:
    # Specifies whether the ServiceAccounts should be created
    create: true
    # The names of the ServiceAccounts to use. If not set and create is
    # true, a name is generated using the fullname template
    controller:
      name: ""
    perouter:
      name: ""
    annotations: {}
  tolerations: []
  priorityClassName: ""
  affinity: {}
  ## Selects which runtime class will be used by the pod.
  runtimeClassName: ""
  podAnnotations: {}
  labels: {}
  controller:
    resources: {}
    # -- Health probe port for liveness and readiness checks
    healthProbePort: 9081
  nodemarker:
    resources: {}
  # grout contains configuration for the optional grout DPDK dataplane sidecar.
  # When enabled, grout runs alongside FRR and accelerates L3 forwarding via
  # DPDK. FRR's dplane_grout module syncs routes automatically to grout.
  grout:
    # -- Enable grout sidecar for DPDK-accelerated L3 routing
    enabled: false
    image:
      repository: quay.io/openperouter/grout
      tag: "latest"
      pullPolicy: IfNotPresent
    # -- Resource requests/limits for grout container.
    # In production (testMode: false), hugepages are required by DPDK.
    resources:
      requests:
        memory: "4Gi"
        hugepages-1Gi: "2Gi"
      limits:
        memory: "4Gi"
        hugepages-1Gi: "2Gi"
    # -- Enable test mode (no DPDK hardware required, uses TAP interfaces)
    testMode: false
    # -- Grout log level. Must be one of: `emerg`, `alert`, `crit`, `err`, `warning`, `notice`, `info` or `debug`.
    logLevel: info
    # -- DPDK EAL arguments (advanced configuration, production only)
    ealArgs: ""
    # -- Grout init script content. Contains grcli commands to configure grout
    # interfaces, routes, and VRFs after startup. Leave empty for no init.
    initScript: ""
  # frr contains configuration specific to the perouter FRR container,
  frr:
    image:
      repository: quay.io/openperouter/openperouter
      tag: ""
      pullPolicy: ""
    resources: {}
    reloader:
      resources: {}
  cri: "containerd" # cri to bind its socket, can be containerd or crio.
  # -- OVS database socket path. Defaults to standard OVS location if not specified.
  ovsSocketPath: ""
  # -- OVS run directory to mount. This is the directory containing the OVS socket.
  ovsRunDir: "/var/run/openvswitch"

webhook:
  enabled: true

crds:
  enabled: true
  validationFailurePolicy: Fail
